<% provide(:page_title, "My Posts") %>

<p id="notice"><%= notice %></p>
<div class = 'container-fluid'>
<div class = "row">
  <div class = "col-sm-2">
        <nav class = "sidenav">
          <ul >
            <% @tags.each do |tag| %>
              <li><%= link_to "#{tag.name}(#{tag.taggings_count})", events_front_path(tag: tag.name) %></li>
            <% end %>
          </ul>
      </nav>
  </div>
  <div class= "col-8">
    <h1>My Posts</h1>
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Content</th>
          <th>Tags</th>
          <th colspan="3"></th>
        </tr>
      </thead>
      <tbody>
        <% @events.each do |event| %>
          <tr>
            <td><%= event.title %></td>
            <td><%= event.content.html_safe %></td>
            <td><%= raw event.tags.map{ |t| link_to t.name, events_front_path(tag: t.name)}.join(', ') %></td>
            <td><%= link_to 'Show', event %></td>
            <% if event.published? %>
              <td><%= link_to 'Unpublish', unpublish_event_path(event.id), method: :put ,data: { confirm: 'Are you sure?' }%></td>
            <% else %>
              <td><%= link_to 'Publish',  publish_event_path(event.id), method: :put ,data: { confirm: 'Are you sure?' }%></td>
            <% end %>
            <td><%= link_to 'Edit', edit_event_path(event) %></td>
            <td><%= link_to 'Destroy', event, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    </div>
  </div>
</div>
    <br>

<%= link_to 'New Event', new_event_path %>
<%= will_paginate  %>